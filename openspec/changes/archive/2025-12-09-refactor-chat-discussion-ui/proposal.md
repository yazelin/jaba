# Proposal: refactor-chat-discussion-ui

## Summary

重構「美食評論區」UI 功能，將管理員介面的聊天功能改為顯示指定群組的 LINE 對話記錄，同時保留看板頁面的美食評論區並改為顯示所有群組的即時對話。

## Motivation

目前「美食評論區」是獨立的團隊聊天功能，與 LINE 群組點餐的對話記錄分離。重構後：
- 管理員可以直接在管理介面查看選定群組與 jaba 的對話紀錄
- 看板頁面可以即時顯示所有群組的點餐對話，方便團隊成員了解訂餐動態

## Scope

### In Scope
1. **管理員介面** (`/manager`)：
   - 移除原「美食評論區」的聊天發送功能
   - 標題改為「{群組名稱} 群組討論」
   - 內容顯示選定群組的 LINE 對話記錄
   - 切換群組時自動更新對話內容
   - LINE Bot 有新對話時即時更新
   - 增加 UI 高度以顯示更多訊息

2. **看板頁面** (`/`)：
   - 保留「美食評論區」標題
   - 改為顯示所有群組與 jaba 的對話（即時聚合）
   - 隔天自動清除

3. **後端 API**：
   - 新增取得指定群組對話記錄的 API
   - 新增/修改 Socket.IO 事件以支援即時更新
   - 在群組對話時同步推送到美食評論區

### Out of Scope
- LINE Bot 端的任何修改
- 原有的 AI 對話功能
- 群組訂單管理功能

## Capabilities

1. **manager-group-chat**: 管理員查看指定群組對話
2. **board-all-groups-chat**: 看板顯示所有群組對話

## Risks & Mitigations

| Risk | Impact | Mitigation |
|------|--------|------------|
| 移除聊天功能可能影響現有使用者 | 低 | 此功能使用率低，且看板仍保留顯示功能 |
| 對話量大時效能問題 | 中 | 限制顯示筆數，每日自動清除 |

## Success Criteria

- [ ] 管理員介面可切換群組並查看對應對話記錄
- [ ] 對話即時更新（無需手動重整）
- [ ] 看板頁面顯示所有群組的即時對話
- [ ] 對話記錄隔天自動清除
